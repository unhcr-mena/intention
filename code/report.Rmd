---
title: "Survey on return intention & perception of Syrian Refugees in Egypt, Iraq and Jordan \n Preliminary exploration of results - draft not for distribution - "
author: "Prepared by UNHCR DOiA"
date: "Amman, `r Sys.Date()`"
output: 
  word_document: 
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    toc: yes
    toc_depth: 2
---

```{r setup, include=FALSE, echo=FALSE, warning=FALSE, message=FALSE}
setwd("D:/R-project/intention")
source("code/1-loaddata.R")

### This part is to manage the survey objects - i.e. With proper statistical adjustment, non-representative polls can be used to generate accurate election forecasts, and often faster and at less expense than traditional survey methods

library(srvyr)
## Convert resulting dataframe from Survey into "survey obbject" using sample ddesign
#data.design <- data %>% 
#  as_survey_design(ids=ID_unit, weight=Prob, nest=TRUE, strata=stratum, variables= c())

## Check poststratification using rake to account for non-coverage issues or non-response
## need to use rake function from survey package

## Compute margin of errors
## Need to use library(samplesize4surveys)


```


***
***
# Executive summary and main findings

***
# Background Introduction


In order to analyse the profile of intention, a stratified random sample of cases was generated for each country to account for governorate of origin, family size and existence of specific needs in the case. The response rate for the survey was __`r paste(round((nrow(data)/nrow(samplefull))*100,digits=1),"%",sep="")`__ (see Annex for more details on the sampling strategy).

This report is an preliminary presentation of the survey’s results and hence, does not include the qualitative analysis, that together with selected extract from this report will form the final version of the reports.


# Intention

## Comparison of intention - for all countries

```{r intention, echo=FALSE, warning=FALSE, cache=FALSE, fig.width=7, fig.height=2}
## Would you consider going back to Syria in the near or not too distant future?

castdata.goingback <- as.data.frame(prop.table(table(data$group_intro.goingback)))
names(castdata.goingback)[1] <- "Intention"
castdata.goingback$Frequency <- paste(round(castdata.goingback$Freq * 100 ,digits=1),"%",sep="")
castdata.goingback <- castdata.goingback[ , c("Intention","Frequency")]

## Print table
#print(pandoc.table(castdata.goingback, rownames = NULL, split.table = 300, split.cells = c( "100%"), use.hyphening = TRUE, justify = 'left'))
kable(castdata.goingback)

## now graphing
data.goingback<- as.data.frame(data[ , c("group_intro.goingback")])
names(data.goingback)[1] <- "Would you consider going back to Syria in the near or not too distant future?"

goingback.likert <- likert(data.goingback)

plot(goingback.likert)


```

## Comparison of intention - per country of asylum

```{r , echo=FALSE, warning=FALSE, cache=FALSE, fig.width=6, fig.height=3}

castdata.goingback.ctr <- as.data.frame(prop.table(table(data$group_intro.goingback,data$ctr),2))
names(castdata.goingback.ctr)[1] <- "Intention"
names(castdata.goingback.ctr)[2] <- "Country"
castdata.goingback.ctr$Frequency <- paste(round(castdata.goingback.ctr$Freq * 100 ,digits=1),"%",sep="")
castdata.goingback.ctr <- castdata.goingback.ctr[ , c("Country","Intention","Frequency")]

#print(pandoc.table(castdata.goingback.ctr, rownames = NULL, split.table = 300, split.cells = c( "100%"), use.hyphening = TRUE, justify = 'left'))
kable(castdata.goingback.ctr)


goingback.likert.ctr <- likert(data.goingback, grouping = data$ctr)
plot(goingback.likert.ctr)



```

## Comparison of intention - per governorate of origin

```{r , echo=FALSE, warning=FALSE, cache=FALSE, fig.width=7, fig.height=6}
goingback.likert.COO_L1 <- likert(data.goingback, grouping = data$COO_L1)

plot(goingback.likert.COO_L1)

```

## Comparison of intention - per case size

```{r , echo=FALSE, warning=FALSE, cache=FALSE, fig.width=7, fig.height=3}
goingback.likert.size <- likert(data.goingback, grouping = data$size)

plot(goingback.likert.size)

```

## Comparison of intention - per occurrence of specific needs

```{r , echo=FALSE, warning=FALSE, cache=FALSE, fig.width=7, fig.height=3}
goingback.likert.needs <- likert(data.goingback, grouping = data$needs)
plot(goingback.likert.needs)

```


***

# Factors influencing intention for those unwilling or undecided to return


## Comparison of factors - for all countries

The following graph is for those unwilling to return. Respondents could select multiple answers.

```{r , echo=FALSE, warning=FALSE, fig.height=7}
data.reasonsnot <- as.data.frame(data[ , c( "reasonnot.propertydoc", "reasonnot.well_settled", 
                                            "reasonnot.displacedcommunity", "reasonnot.fearsretaliation", 
                                            "reasonnot.resettlement", "reasonnot.no_educ", 
                                            "reasonnot.fears", "reasonnot.resttleinterest", 
                                            "reasonnot.nosaving", "reasonnot.familydecision", 
                                            "reasonnot.fearsdetention", "reasonnot.registerchild", 
                                            "reasonnot.livelihood", "reasonnot.avoid_military", 
                                            "reasonnot.no_medservice", "reasonnot.spec_need", 
                                            "reasonnot.bad_secu", "reasonnot.lackshelter", 
                                            "reasonnot.civildoc", "reasonnot.nowaterservice", 
                                            "reasonnot.noelect")])
data.reasonsnot$id <- rownames(data.reasonsnot)
meltdata.reasonsnot <- melt(data.reasonsnot,id=c("id"))
meltdata.reasonsnot <- meltdata.reasonsnot[meltdata.reasonsnot$value!="Not selected", ]
meltdata.reasonsnot <- meltdata.reasonsnot[meltdata.reasonsnot$value!="Not replied", ]

castdata.reasonsnot <- as.data.frame(prop.table(table(meltdata.reasonsnot$value)))
castdata.reasonsnot$Var1 <-factor(castdata.reasonsnot$Var1, levels=castdata.reasonsnot[order(castdata.reasonsnot$Freq), "Var1"])


goingback.reasonsnot  <-  ggplot(castdata.reasonsnot, aes(x = Var1, y=Freq)) +
  geom_bar( stat = "identity",
          #  fill="#2a87c8",colour="#2a87c8") +
          fill="skyblue3",colour="#2a87c8") +
  coord_flip() +
  #scale_fill_brewer(palette = "RdYlBu") + 
  guides(fill = guide_legend(reverse=TRUE)) +
  ylab("") +
  xlab("") +
  ggtitle("Why do you not or would you never consider going back to Syria?") +
  labs(fill="")+
  scale_y_continuous(labels=percent)+
#  theme_pander()+
  theme(plot.title = element_text(size=12, hjust = 0.8)) +  #, hjust=0.5
  ###theme(axis.text.y = element_text(hjust=0)) +
  #theme(axis.text.y=element_blank())+
  theme(legend.position="top", legend.direction="horizontal") 
goingback.reasonsnot 


```

## Comparison of factors - per country of asylum 

The following graph is for those unwilling to return. Respondents could select multiple answers.

```{r , echo=FALSE, warning=FALSE, fig.height=7}

data.reasonsnot.ctr <- as.data.frame(data[ , c( "reasonnot.propertydoc", "reasonnot.well_settled", 
                                            "reasonnot.displacedcommunity", "reasonnot.fearsretaliation", 
                                            "reasonnot.resettlement", "reasonnot.no_educ", 
                                            "reasonnot.fears", "reasonnot.resttleinterest", 
                                            "reasonnot.nosaving", "reasonnot.familydecision", 
                                            "reasonnot.fearsdetention", "reasonnot.registerchild", 
                                            "reasonnot.livelihood", "reasonnot.avoid_military", 
                                            "reasonnot.no_medservice", "reasonnot.spec_need", 
                                            "reasonnot.bad_secu", "reasonnot.lackshelter", 
                                            "reasonnot.civildoc", "reasonnot.nowaterservice", 
                                            "reasonnot.noelect",
                                            "ctr")])
data.reasonsnot.ctr$id <- rownames(data.reasonsnot.ctr)
meltdata.reasonsnot.ctr <- melt(data.reasonsnot.ctr,id=c("id","ctr"))
meltdata.reasonsnot.ctr <- meltdata.reasonsnot.ctr[meltdata.reasonsnot.ctr$value!="Not selected", ]
meltdata.reasonsnot.ctr <- meltdata.reasonsnot.ctr[meltdata.reasonsnot.ctr$value!="Not replied", ]

castdata.reasonsnot.ctr <- as.data.frame(prop.table(table(meltdata.reasonsnot.ctr$value, meltdata.reasonsnot.ctr$ctr),2))
castdata.reasonsnot.ctr$Var1 <-factor(castdata.reasonsnot.ctr$Var1, levels=castdata.reasonsnot[order(castdata.reasonsnot$Freq), "Var1"])



goingback.reasonsnot.ctr  <-  ggplot(castdata.reasonsnot.ctr, aes(x = Var1, y=Freq)) +
  geom_bar( stat = "identity",
            fill="skyblue3",colour="#2a87c8") +
  coord_flip() +
  facet_wrap(~ Var2, ncol=3) + 
  guides(fill = guide_legend(reverse=TRUE)) +
  ylab("") +
  xlab("") +
  ggtitle("Why do you not or would you never consider going back to Syria?") +
  labs(fill="")+
  scale_y_continuous(labels=percent)+
  theme(plot.title = element_text(size=12, hjust = 0.8)) +  #, hjust=0.5
  ###theme(axis.text.y = element_text(hjust=0)) +
  #theme(axis.text.y=element_blank())+
  theme(legend.position="top", legend.direction="horizontal") 
goingback.reasonsnot.ctr 
```


## Comparison of factors - for all countries

The following graph is for those undecided to return. Respondents could select multiple answers.

```{r , echo=FALSE, warning=FALSE, fig.height=7}
data.reasonundecided <- as.data.frame(data[ , c( "reasonundecided.access_to_school", 
                  "reasonundecided.electrictiy", "reasonundecided.amnesty", 
                  "reasonundecided.wait_resttle", "reasonundecided.shelter", 
                  "reasonundecided.political", "reasonundecided.familydecision", 
                  "reasonundecided.community", "reasonundecided.livelihood", 
                  "reasonundecided.water", "reasonundecided.wait_school", 
                  "reasonundecided.health", "reasonundecided.reliableinfo", 
                  "reasonundecided.civildoc", "reasonundecided.spec_need", 
                  "reasonundecided.security", "reasonundecided.desert", 
                  "reasonundecided.wait_info")])
data.reasonundecided$id <- rownames(data.reasonundecided)
meltdata.reasonundecided <- melt(data.reasonundecided,id=c("id"))
meltdata.reasonundecided <- meltdata.reasonundecided[meltdata.reasonundecided$value!="Not selected", ]
meltdata.reasonundecided <- meltdata.reasonundecided[meltdata.reasonundecided$value!="Not replied", ]

castdata.reasonundecided <- as.data.frame(prop.table(table(meltdata.reasonundecided$value)))
castdata.reasonundecided$Var1 <-factor(castdata.reasonundecided$Var1, levels=castdata.reasonundecided[order(castdata.reasonundecided$Freq), "Var1"])


goingback.reasonundecided  <-  ggplot(castdata.reasonundecided, aes(x = Var1, y=Freq)) +
  geom_bar( stat = "identity",
            fill="skyblue3",colour="#2a87c8") +
  coord_flip() +
  #scale_fill_brewer(palette = "RdYlBu") + 
  guides(fill = guide_legend(reverse=TRUE)) +
  ylab("") +
  xlab("") +
  ggtitle("If you are undecided/don't know about returning to Syria, what would help you decide?") +
  labs(fill="")+
  scale_y_continuous(labels=percent)+
  theme(plot.title = element_text(size=12, hjust = 0.8)) +  #, hjust=0.5
  ##theme(axis.text.y = element_text(hjust=0)) +
  #theme(axis.text.y=element_blank())+
  theme(legend.position="top", legend.direction="horizontal") 
goingback.reasonundecided 


```

## Comparison of factors - per country

The following graph is for those undecided to return. Respondents could select multiple answers.

```{r , echo=FALSE, warning=FALSE, fig.height=7}

data.reasonundecided.ctr <- as.data.frame(data[ , c("reasonundecided.access_to_school", 
                                  "reasonundecided.electrictiy", "reasonundecided.amnesty", 
                                  "reasonundecided.wait_resttle", "reasonundecided.shelter", 
                                  "reasonundecided.political", "reasonundecided.familydecision", 
                                  "reasonundecided.community", "reasonundecided.livelihood", 
                                  "reasonundecided.water", "reasonundecided.wait_school", 
                                  "reasonundecided.health", "reasonundecided.reliableinfo", 
                                  "reasonundecided.civildoc", "reasonundecided.spec_need", 
                                  "reasonundecided.security", "reasonundecided.desert", 
                                  "reasonundecided.wait_info",
                                            "ctr")])
data.reasonundecided.ctr$id <- rownames(data.reasonundecided.ctr)
meltdata.reasonundecided.ctr <- melt(data.reasonundecided.ctr,id=c("id","ctr"))
meltdata.reasonundecided.ctr <- meltdata.reasonundecided.ctr[meltdata.reasonundecided.ctr$value!="Not selected", ]
meltdata.reasonundecided.ctr <- meltdata.reasonundecided.ctr[meltdata.reasonundecided.ctr$value!="Not replied", ]

castdata.reasonundecided.ctr <- as.data.frame(prop.table(table(meltdata.reasonundecided.ctr$value, meltdata.reasonundecided.ctr$ctr),2))
castdata.reasonundecided.ctr$Var1 <-factor(castdata.reasonundecided.ctr$Var1, levels=castdata.reasonundecided[order(castdata.reasonundecided$Freq), "Var1"])



goingback.reasonundecided.ctr  <-  ggplot(castdata.reasonundecided.ctr, aes(x = Var1, y=Freq)) +
  geom_bar( stat = "identity",
            fill="skyblue3",colour="#2a87c8") +
  coord_flip() +
  facet_wrap(~ Var2, ncol=3) + 
  guides(fill = guide_legend(reverse=TRUE)) +
  ylab("") +
  xlab("") +
  ggtitle("Why do you not or would you never consider going back to Syria?") +
  labs(fill="")+
  scale_y_continuous(labels=percent)+
  theme(plot.title = element_text(size=12, hjust = 0.8)) +  #, hjust=0.5
  ##theme(axis.text.y = element_text(hjust=0)) +
  #theme(axis.text.y=element_blank())+
  theme(legend.position="top", legend.direction="horizontal") 
goingback.reasonundecided.ctr 
```


***

# Factors influencing intention for those willing to return

A total of __`r nrow(data[!(is.na(data$reasons.security)) ,])`__ respondents indicated their intention to return.

## Comparison of factors - for all countries

The following graph is for those willing to return.

```{r reasons, echo=FALSE, warning=FALSE, fig.height=10}
data.reasons <- data[!(is.na(data$reasons.security)) , c("reasons.security", "reasons.political", 
                          "reasons.work", "reasons.no_service", "reasons.shelter", 
                          "reasons.property", "reasons.educ", "reasons.assit_return", 
                           "reasons.avoid_military", "reasons.recruitment", "reasons.specific_need", 
                           "reasons.resettlement_pipe", "reasons.well_settled", "reasons.wait_info", 
                            "reasons.wait_school", "reasons.family_reunifi", "reasons.no_saving", 
                           "reasons.expired_residency", "reasons.familyreturn", "reasons.Communit", 
                            "reasons.problems", "reasons.docu_from_syria", "reasons.land_property")]

data.reasons <- kobo_label(data.reasons,dico)


for (i in 1:23) {
  data.reasons[ , i] <- factor(data.reasons[ , i],levels=c('Not relevant','No impact','Little impact','Has an impact'))
  names(data.reasons)[i] <- attributes(data.reasons)$variable.labels[i]
  #levels(as.factor(data$group_intro.goingback))
}

reasons.likert <- likert(data.reasons)

plot(reasons.likert)


```


## Comparison of factors - per country of asylum

The following graph is for those willing to return.

```{r reasonsctr, echo=FALSE, warning=FALSE, fig.width=7, fig.height=11}

data.reasons1 <- data[!(is.na(data$reasons.security)) , c("reasons.security",
                                                          "reasons.work", "reasons.no_service",
                                                          "reasons.family_reunifi","reasons.wait_school"
                                                        #  "reasons.political",  "reasons.shelter"#, 
                                                        #  "reasons.assit_return","reasons.well_settled",
                                                        #  "reasons.educ",  "reasons.specific_need"
                                                          #,
                                                        ##
                                                        # "reasons.avoid_military", "reasons.recruitment",
                                                        # "reasons.property",  "reasons.resettlement_pipe", 
                                                        #  "reasons.no_saving",  "reasons.wait_info",
                                                        # "reasons.expired_residency", "reasons.familyreturn", "reasons.Communit", 
                                                        #  "reasons.problems", "reasons.docu_from_syria", "reasons.land_property"
                                                        )]

data.reasons1 <- kobo_label(data.reasons1,dico)

#### Second chart
data.reasons2 <- data[!(is.na(data$reasons.security)) , c( #"reasons.security",
                                                          #"reasons.work", "reasons.no_service",
                                                          #"reasons.family_reunifi","reasons.wait_school",
                                                         "reasons.political",  "reasons.shelter", 
                                                          "reasons.assit_return","reasons.well_settled",
                                                          "reasons.educ",  "reasons.specific_need"
                                                         
                                                       #  "reasons.avoid_military", "reasons.recruitment",
                                                        # "reasons.property",  "reasons.resettlement_pipe"#, 
                                                         # "reasons.no_saving",  "reasons.wait_info",
                                                        # "reasons.expired_residency", "reasons.familyreturn", "reasons.Communit", 
                                                         # "reasons.problems", "reasons.docu_from_syria", "reasons.land_property"
                                                        )]

data.reasons2 <- kobo_label(data.reasons2,dico)

#### Second chart
data.reasons3 <- data[!(is.na(data$reasons.security)) , c( #"reasons.security",
                                                          #"reasons.work", "reasons.no_service",
                                                          #"reasons.family_reunifi","reasons.wait_school",
                                                          #"reasons.political",  "reasons.shelter", 
                                                          #"reasons.assit_return","reasons.well_settled",
                                                          #"reasons.educ",  "reasons.specific_need"
                                                          #,
                                                        ##
                                                         "reasons.avoid_military", "reasons.recruitment",
                                                         "reasons.property",  "reasons.resettlement_pipe", 
                                                          "reasons.no_saving",  "reasons.wait_info"
                                                        # "reasons.expired_residency", "reasons.familyreturn", "reasons.Communit", 
                                                        #  "reasons.problems", "reasons.docu_from_syria", "reasons.land_property"
                                                        )]

data.reasons3 <- kobo_label(data.reasons3,dico)

#### Second chart
data.reasons4 <- data[!(is.na(data$reasons.security)) , c( #"reasons.security",
                                                          #"reasons.work", "reasons.no_service",
                                                          #"reasons.family_reunifi","reasons.wait_school",
                                                          #"reasons.political",  "reasons.shelter", 
                                                          #"reasons.assit_return","reasons.well_settled",
                                                          #"reasons.educ",  "reasons.specific_need"
                                                          #,
                                                        ##
                                                       #  "reasons.avoid_military", "reasons.recruitment",
                                                        # "reasons.property",  "reasons.resettlement_pipe", 
                                                        #  "reasons.no_saving",  "reasons.wait_info",
                                                         "reasons.expired_residency", "reasons.familyreturn", "reasons.Communit", 
                                                          "reasons.problems", "reasons.docu_from_syria", "reasons.land_property")]

data.reasons4 <- kobo_label(data.reasons4,dico)

for (i in 1:ncol(data.reasons1)) {
  data.reasons1[ , i] <- factor(data.reasons1[ , i],levels=c('Not relevant','No impact','Little impact','Has an impact'))
  names(data.reasons1)[i] <- attributes(data.reasons1)$variable.labels[i]
  #levels(as.factor(data$group_intro.goingback))
}


for (i in 1:ncol(data.reasons2)) {
  data.reasons2[ , i] <- factor(data.reasons2[ , i],levels=c('Not relevant','No impact','Little impact','Has an impact'))
  names(data.reasons2)[i] <- attributes(data.reasons2)$variable.labels[i]
  #levels(as.factor(data$group_intro.goingback))
}

for (i in 1:ncol(data.reasons3)) {
  data.reasons3[ , i] <- factor(data.reasons3[ , i],levels=c('Not relevant','No impact','Little impact','Has an impact'))
  names(data.reasons3)[i] <- attributes(data.reasons3)$variable.labels[i]
  #levels(as.factor(data$group_intro.goingback))
}

for (i in 1:ncol(data.reasons4)) {
  data.reasons4[ , i] <- factor(data.reasons4[ , i],levels=c('Not relevant','No impact','Little impact','Has an impact'))
  names(data.reasons4)[i] <- attributes(data.reasons4)$variable.labels[i]
  #levels(as.factor(data$group_intro.goingback))
}

reasons.likert.ctr1 <- likert(data.reasons1, grouping = data[!(is.na(data$reasons.security)) , c("ctr")])
plot(reasons.likert.ctr1)

reasons.likert.ctr2 <- likert(data.reasons2, grouping = data[!(is.na(data$reasons.security)) , c("ctr")])
plot(reasons.likert.ctr2)

reasons.likert.ctr3 <- likert(data.reasons3, grouping = data[!(is.na(data$reasons.security)) , c("ctr")])
plot(reasons.likert.ctr3)

reasons.likert.ctr4 <- likert(data.reasons4, grouping = data[!(is.na(data$reasons.security)) , c("ctr")])
plot(reasons.likert.ctr4)
```


## Comparison of factors - per governorate of origin 

The following graph is for those willing to return.

```{r reasonsgov, echo=FALSE, warning=FALSE, fig.width=7, fig.height=11}


reasons.likert.cool11 <- likert(data.reasons1, grouping = data[!(is.na(data$reasons.security)) , c("COO_L1")])
plot(reasons.likert.cool11)

reasons.likert.cool12 <- likert(data.reasons2, grouping = data[!(is.na(data$reasons.security)) , c("COO_L1")])
plot(reasons.likert.cool12)

reasons.likert.cool13 <- likert(data.reasons3, grouping = data[!(is.na(data$reasons.security)) , c("COO_L1")])
plot(reasons.likert.cool13)

reasons.likert.cool14 <- likert(data.reasons4, grouping = data[!(is.na(data$reasons.security)) , c("COO_L1")])
plot(reasons.likert.cool14)

```

## Comparison of factors for those willing to return -  per case size

```{r reasonscase, echo=FALSE, warning=FALSE, fig.width=7, fig.height=10}

reasons.likert.size1 <- likert(data.reasons1, grouping = data[!(is.na(data$reasons.security)) , c("size")])
plot(reasons.likert.size1)

reasons.likert.size2 <- likert(data.reasons2, grouping = data[!(is.na(data$reasons.security)) , c("size")])
plot(reasons.likert.size2)

reasons.likert.size3 <- likert(data.reasons3, grouping = data[!(is.na(data$reasons.security)) , c("size")])
plot(reasons.likert.size3)

reasons.likert.size4 <- likert(data.reasons4, grouping = data[!(is.na(data$reasons.security)) , c("size")])
plot(reasons.likert.size4)

```

***

# Modalities for those who expressed willingness to return

## Comparision of modalities - for all countries

The following graph is for those willing to return.

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-52
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-118
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```




```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-119
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-120
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-121
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-122
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```

## Comparision of modalities - per country of asylum

The following graph is for those willing to return.

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-52
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-118
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```




```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-119
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-120
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-121
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-122
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```





## Comparision of modalities - per governorate of origin

The following graph is for those willing to return.

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-52
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-118
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```




```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-119
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-120
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-121
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-122
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



***

# Priorities for return for those who expressed willingness to return 

Respondents who expressed willingness to return, were requested to define order of priority for a series of issues in line with what they thought to be the three main issues that needs to be improved on in Syria for people to return.

## Ranking of priorities - for all countries

The following graph is for those willing to return.

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=6}

#### Need to reoorganise data
data.priority <- as.data.frame(data[ !(is.na(data$grouppriority.first)) , c( "grouppriority.first",
                                                                                 "grouppriority.second",
                                                                                 "grouppriority.third")])
data.priority$id <- rownames(data.priority)

meltdata.priority <- melt(data.priority,id=c("id"))
castdata.priority1<- as.data.frame(prop.table(table(meltdata.priority$value)))
castdata.priority<- as.data.frame(prop.table(table(meltdata.priority$value, meltdata.priority$variable)))

castdata.priority$Var1 <-factor(castdata.priority$Var1, levels=castdata.priority[order(castdata.priority1$Freq), "Var1"])

## Recoding and ordering priorities
castdata.priority$Var2 <- as.character(castdata.priority$Var2)
castdata.priority$Var2[castdata.priority$Var2=="grouppriority.third"] <- "Third priority"
castdata.priority$Var2[castdata.priority$Var2=="grouppriority.second"] <- "Second priority"
castdata.priority$Var2[castdata.priority$Var2=="grouppriority.first"] <- "First priority"

castdata.priority$Var2 <-factor(castdata.priority$Var2, levels=c("Third priority","Second priority","First priority"))

goingback.priority  <-  ggplot(castdata.priority, aes(x = Var1, fill=Var2, y=Freq)) +
  geom_bar( stat = "identity", colour="#2a87c8") +
  coord_flip() +
 # facet_wrap(~ Var3, ncol=3) + 
  guides(fill = guide_legend(reverse=TRUE)) +
  ylab("") +
  xlab("") +
  ggtitle("Main issues that needs to be improved on in Syria for people to return") +
  labs(fill="")+
  scale_y_continuous(labels=percent)+
  scale_fill_brewer(palette = "PuOR") + 
  theme(plot.title = element_text(size=12, hjust = 0.8)) +  #, hjust=0.5
  ##theme(axis.text.y = element_text(hjust=0)) +
  #theme(axis.text.y=element_blank())+
  theme(legend.position="top", legend.direction="horizontal") 
goingback.priority 
```

## Ranking of priorities - per country of asylum

The following graph is for those willing to return.

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=6}

data.priority.ctr <- as.data.frame(data[ !(is.na(data$grouppriority.first)) , c( "grouppriority.first",
                                                                                 "grouppriority.second",
                                                                                 "grouppriority.third",
                                                                                 "ctr")])
data.priority.ctr$id <- rownames(data.priority.ctr)

meltdata.priority.ctr <- melt(data.priority.ctr,id=c("id","ctr"))
castdata.priority.ctr <- as.data.frame(prop.table(table(meltdata.priority.ctr$value, meltdata.priority.ctr$variable,meltdata.priority.ctr$ctr),3))
castdata.priority.ctr$Var1 <-factor(castdata.priority.ctr$Var1, levels=castdata.priority[order(castdata.priority1$Freq), "Var1"])

## Recoding and ordering priorities
castdata.priority.ctr$Var2 <- as.character(castdata.priority.ctr$Var2)
castdata.priority.ctr$Var2[castdata.priority.ctr$Var2=="grouppriority.third"] <- "Third priority"
castdata.priority.ctr$Var2[castdata.priority.ctr$Var2=="grouppriority.second"] <- "Second priority"
castdata.priority.ctr$Var2[castdata.priority.ctr$Var2=="grouppriority.first"] <- "First priority"

castdata.priority.ctr$Var2 <-factor(castdata.priority.ctr$Var2, levels=c("Third priority","Second priority","First priority"))


goingback.priority.ctr  <-  ggplot(castdata.priority.ctr, aes(x = Var1, fill=Var2, y=Freq)) +
  geom_bar( stat = "identity" , colour="#2a87c8") +
  coord_flip() +
  facet_wrap(~ Var3, ncol=3) + 
  guides(fill = guide_legend(reverse=TRUE)) +
  ylab("") +
  xlab("") +
  ggtitle("Main issues that needs to be improved on in Syria for people to return") +
  labs(fill="")+
  scale_y_continuous(labels=percent)+
  scale_fill_brewer(palette = "PuOR") + 
  theme(plot.title = element_text(size=12, hjust = 0.8)) +  #, hjust=0.5
  ##theme(axis.text.y = element_text(hjust=0)) +
  #theme(axis.text.y=element_blank())+
  theme(legend.position="top", legend.direction="horizontal") 
goingback.priority.ctr 

```


## Ranking of priorities - per governorate of origin

The following graph is for those willing to return. 

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=10}

data.priority.cool <- as.data.frame(data[ !(is.na(data$grouppriority.first)) , c( "grouppriority.first",
                                                                                 "grouppriority.second",
                                                                                 "grouppriority.third",
                                                                                 "COO_L1")])
data.priority.cool$id <- rownames(data.priority.cool)

meltdata.priority.cool <- melt(data.priority.cool,id=c("id","COO_L1"))
castdata.priority.cool <- as.data.frame(prop.table(table(meltdata.priority.cool$value, meltdata.priority.cool$variable,meltdata.priority.cool$COO_L1),3))
castdata.priority.cool$Var1 <-factor(castdata.priority.cool$Var1, levels=castdata.priority[order(castdata.priority1$Freq), "Var1"])



## Recoding and ordering priorities
castdata.priority.cool$Var2 <- as.character(castdata.priority.cool$Var2)
castdata.priority.cool$Var2[castdata.priority.cool$Var2=="grouppriority.third"] <- "Third priority"
castdata.priority.cool$Var2[castdata.priority.cool$Var2=="grouppriority.second"] <- "Second priority"
castdata.priority.cool$Var2[castdata.priority.cool$Var2=="grouppriority.first"] <- "First priority"

castdata.priority.cool$Var2 <-factor(castdata.priority.cool$Var2, levels=c("Third priority","Second priority","First priority"))


goingback.priority.cool  <-  ggplot(castdata.priority.cool, aes(x = Var1, fill=Var2, y=Freq)) +
  geom_bar( stat = "identity" , colour="#2a87c8") +
  coord_flip() +
  facet_wrap(~ Var3, ncol=3) + 
  guides(fill = guide_legend(reverse=TRUE)) +
  ylab("") +
  xlab("") +
  ggtitle("Main issues that needs to be improved on in Syria for people to return") +
  labs(fill="")+
  scale_y_continuous(labels=percent) +
  scale_fill_brewer(palette = "PuOR") + 
  theme(plot.title = element_text(size=12, hjust = 0.8)) +  #, hjust=0.5
  ##theme(axis.text.y = element_text(hjust=0)) +
  #theme(axis.text.y=element_blank())+
  theme(legend.position="top", legend.direction="horizontal") 
goingback.priority.cool 

```

***

# Additional questions for all respondents

## Comparison of conditions for return - for all countries

The following graph is for all respondents.

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-123
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-124
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-125
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-126
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-127
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-128
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-129
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title,  
              subtitle ="This graphs displays unique combination of multiple answers")+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```





## Comparison of conditions for return - per expressed intention

The following graphs displays the same series of questions for all respondents but according to the intial expressed intentions.

```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-123
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ group_intro.goingback, ncol=4) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-124
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ group_intro.goingback, ncol=4) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-125
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ group_intro.goingback, ncol=4) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-126
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ group_intro.goingback, ncol=4) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-127
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ group_intro.goingback, ncol=4) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-128
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ group_intro.goingback, ncol=4) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-129
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ group_intro.goingback, ncol=4) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title,  
              subtitle ="This graphs displays unique combination of multiple answers")+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```

## Comparison of condition for return - per country of asylum


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-123
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=5}
    i <-124
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-125
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-126
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-127
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-128
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=3}
    i <-129
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ ctr, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title,  
              subtitle ="This graphs displays unique combination of multiple answers")+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```


## Comparison of condition for return - per governorate of origin


```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=8}
    i <-123
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=12}
    i <-124
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=8}
    i <-125
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=8}
    i <-126
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=8}
    i <-127
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=8}
    i <-128
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title)+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```



```{r , echo=FALSE, warning=FALSE, fig.width=7, fig.height=8}
    i <-129
variablename <- names(data)[i]
title <- attributes(data)$variable.labels[i]
frequ <- table (data[ , i])
data[ , i] <- factor(data[ , i], levels=names(frequ[rev(order(frequ, decreasing = TRUE))]))

## subsetting to those who replied
data1 <- data[ !(is.na(data[ ,i])), ]

## and now the graph
plotfreq <- ggplot(data1, aes(data1[ , i])) +
  geom_bar(aes(y = ..count.. / sapply(PANEL, FUN=function(x) sum(count[PANEL == x]))),
           fill="skyblue3",colour="#2a87c8") +
  facet_wrap(~ COO_L1, ncol=3) +
  guides(fill=FALSE) +
  ylab("Frequency") +
  scale_y_continuous(labels=percent)+
  xlab("") +
  coord_flip() +
  ggtitle(title,  
              subtitle ="This graphs displays unique combination of multiple answers")+
  theme(plot.title=element_text(face="bold", size=9),
        plot.background = element_rect(fill = "transparent",colour = NA))

plotfreq

```




# Annex: Sampling strategy

The reliability of a survey and the consistency of its result is heavily linked to the sampling strategy used to perform it. Through stratification, the sampling strategy should allow for good representation of the population characteristics keeping considerations to limit the sample size within acceptable ranges.

## Definition of the strata 

In statistical surveys, when subpopulations within an overall population vary, it is advantageous to sample each subpopulation (stratum) independently. Stratification is the process of dividing members of the population into homogeneous subgroups before randomly sampling respondents.

In the current case, based on the analysis of previous voluntary departure, it is assumed that two levels of stratification are required: 

  1.	The first level define the distinct groups that will be used to define the sample. This level will be based on the main discriminators for the intention and perception to return are both the Country of Asylum and the Governorate in the Country of Origin. 
  
  2.	The second level is used for proportional allocation of characteristics within each sample. This will include characteristics that are foreseen as having important correlations with decision to return :
  
   *	Occurrence of Specific Needs (2 classes)
   *	Case size – Re-categorized using the following 5 classes (1 persons; 2 persons; 3 to 5 persons; over 5 persons)

The strategy assumes that intention are actually homogeneous at the case level (i.e. Household) and that as a matter of rule, the return will not imply family separation.
Calculation of the sample size for each country

With the stratified random sample, there is an equal chance (probability) of selecting each unit from within a particular stratum (group) of the population when creating the sample. In order to detect differentiation of intention depending on the specific area of origin within Syria, the number of cases per Main Governorate of Origin within each country of Asylum can be used to define the strata. 

Governorate of Origin are grouped together if the number of cases per governorate does not exceed 5% of the total number of case in the country asylum. This approach allows to reduce the numbers of strata in order to avoid oversampling some governorate of origin. 

In order to keep sample size at a reasonable level, the following variables are used:

 *	Confidence interval: 95% is suggested 
 
 *	Width of Confidence Interval (i.e. margin of error): + or 5% is suggested
 
 *	Expected value of Attribute: The main attribute is “decision to return”. Based on the recent intention survey, we assume the attribute, 30% is suggested
 
## Sample response & final weighting

When data are used without weights, each record counts the same as any other record and this implies the following assumptions:

 *	Each record has equal probabilities of being selected. 
 
 *	Noncoverage and nonresponse are equal among all segments of the population. 
 
During data collection, the conditions that actually happen may be different than the preceding assumptions, and the differences can become large enough to affect the results of the data set. Weighting each record appropriately can help to adjust for these differences (or assumption violations).

Another reason for weighting, one that is conceptually unrelated to the first reason, is to make the total number of cases equal to some desired number. Such _raking_ (or "[post-stratification](https://www.r-bloggers.com/survey-computing-your-own-post-stratification-weights-in-r/") serves as a blanket adjustment for noncoverage and nonresponse and forces the total number of cases to equal population estimates for each geographic region. 